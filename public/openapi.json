{
    "openapi": "3.1.0",
    "info": {
        "title": "Hotel Management API",
        "version": "1.0.0"
    },
    "paths": {
        "/api/user/get/getall": {
            "get": {
                "tags": [
                    "User"
                ],
                "summary": "Get all users",
                "responses": {
                    "200": {
                        "description": "List of users"
                    }
                }
            }
        },
        "/api/user/get/user": {
            "get": {
                "tags": [
                    "User"
                ],
                "summary": "Get current user info",
                "description": "Returns the currently authenticated user info, excluding the password",
                "responses": {
                    "200": {
                        "description": "User found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "404": {
                        "description": "Token or User not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/get/getbyid/{id}": {
            "get": {
                "tags": [
                    "User"
                ],
                "summary": "Get by id user",
                "responses": {
                    "200": {
                        "description": "User found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/delete/{id}": {
            "delete": {
                "tags": [
                    "User"
                ],
                "summary": "Delete user by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User deleted"
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        },
        "/api/user/post/login": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "User login",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string"
                                    },
                                    "password": {
                                        "type": "string"
                                    },
                                    "rememberMe": {
                                        "type": "boolean"
                                    }
                                },
                                "required": [
                                    "email",
                                    "password"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful"
                    },
                    "401": {
                        "description": "Password is wrong"
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        },
        "/api/user/post/register": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "User register",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "firstname": {
                                        "type": "string"
                                    },
                                    "lastname": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "firstname",
                                    "lastname",
                                    "email",
                                    "password"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User registered successfully"
                    },
                    "400": {
                        "description": "Validation error / Email exists"
                    }
                }
            }
        },
        "/api/user/post/logout": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Logout user",
                "responses": {
                    "200": {
                        "description": "Logged out successfully"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/post/refresh-token": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Refresh access token",
                "responses": {
                    "200": {
                        "description": "New access token set"
                    },
                    "401": {
                        "description": "No token"
                    },
                    "403": {
                        "description": "Invalid refresh token"
                    }
                }
            }
        },
        "/api/user/post/forgot-password-send-otp": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Send OTP for password reset",
                "description": "Generates and sends a 6-digit OTP to the user's email address for password reset. OTP is valid for 5 minutes.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    }
                                },
                                "required": [
                                    "email"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OTP sent successfully"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Failed to send OTP or server error"
                    }
                }
            }
        },
        "/api/user/post/forgot-password-verify-otp": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Verify OTP for password reset",
                "description": "Verifies the 6-digit OTP code previously sent to the user’s email. If valid, user can proceed to reset password.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "otp": {
                                        "type": "string",
                                        "example": "123456"
                                    }
                                },
                                "required": [
                                    "email",
                                    "otp"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OTP verified successfully"
                    },
                    "400": {
                        "description": "Invalid or expired OTP"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/post/reset-password": {
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Reset user password",
                "description": "Allows a user to set a new password after successful OTP verification. Password must meet validation rules.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "newPassword": {
                                        "type": "string",
                                        "minLength": 8,
                                        "maxLength": 16
                                    },
                                    "confirmPassword": {
                                        "type": "string",
                                        "minLength": 8,
                                        "maxLength": 16
                                    }
                                },
                                "required": [
                                    "email",
                                    "newPassword",
                                    "confirmPassword"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password reset successfully"
                    },
                    "400": {
                        "description": "Validation or mismatch error"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/patch": {
            "tags": [
                "User"
            ],
            "patch": {
                "summary": "Update user info",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "firstname": {
                                        "type": "string",
                                        "maxLength": 15
                                    },
                                    "lastname": {
                                        "type": "string",
                                        "maxLength": 15
                                    }
                                },
                                "required": [
                                    "id",
                                    "firstname",
                                    "lastname"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/user/patch/role/{id}": {
            "patch": {
                "tags": [
                    "User"
                ],
                "summary": "Toggle user's admin role",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Role updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/get/getall": {
            "get": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Get all feedbacks",
                "responses": {
                    "200": {
                        "description": "List of feedbacks"
                    }
                }
            }
        },
        "/api/feedback/get/getbyid/{id}": {
            "get": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Get by id feeback info",
                "responses": {
                    "200": {
                        "description": "Feedback found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Feedback"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "404": {
                        "description": "Token or Feedback not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/get/getallsoftdeleted": {
            "get": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Get all softdeleted feedbacks",
                "responses": {
                    "200": {
                        "description": "List of feedbacks"
                    }
                }
            }
        },
        "/api/feedback/delete/{id}": {
            "delete": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Delete feedback by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Feedback deleted"
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "404": {
                        "description": "Token or Feedback not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/softdelete/{id}": {
            "delete": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Soft delete a feedback (admin only)",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "The ID of the feedback to be soft deleted"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Feedback soft deleted successfully"
                    },
                    "400": {
                        "description": "Feedback already soft deleted or validation error"
                    },
                    "401": {
                        "description": "Invalid token"
                    },
                    "403": {
                        "description": "User is not admin"
                    },
                    "404": {
                        "description": "Feedback or token not found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/feedback/post": {
            "post": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Feedback post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "fromMail": {
                                        "type": "string"
                                    },
                                    "description": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "fromMail",
                                    "description"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Feedback create successfully"
                    },
                    "400": {
                        "description": "Email is required or Please enter a valid email or Feedback description is required or Feedback description maximum 100 characters."
                    }
                }
            }
        },
        "/api/feedback/patch": {
            "patch": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Update feedback info",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "description": {
                                        "type": "string",
                                        "maxLength": 100
                                    }
                                },
                                "required": [
                                    "id",
                                    "description"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Feedback updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Feedback"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "403": {
                        "description": "You are not admin"
                    },
                    "404": {
                        "description": "Token or Feedback not found"
                    },
                    "400": {
                        "description": "Feedback description is required or Feedback description maximum 100 characters."
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/patch/restorebyid/{id}": {
            "patch": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Restore by id feedback",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "id"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Feedback restored"
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "403": {
                        "description": "You are not admin"
                    },
                    "404": {
                        "description": "Token or Feedback not found"
                    },
                    "400": {
                        "description": "Feedback already restored"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/patch/restoreall": {
            "patch": {
                "tags": [
                    "Feedback"
                ],
                "summary": "Restore all feedbacks",
                "responses": {
                    "200": {
                        "description": "Feedbacks restored"
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "403": {
                        "description": "You are not admin"
                    },
                    "404": {
                        "description": "Token or Soft deleted feedbacks not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/feedback/patch/read/{id}": {
            "patch": {
                "tags": [
                    "Feedback"
                ],
                "summary": "isRead change feedback",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "id"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Feedback marked as read or Feedback marked as unread"
                    },
                    "401": {
                        "description": "Token is invalid"
                    },
                    "403": {
                        "description": "You are not admin"
                    },
                    "404": {
                        "description": "Token or Feedback not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/room/post": {
            "post": {
                "tags": [
                    "Room"
                ],
                "summary": "Create a new Room",
                "description": "Creates a new room entry, uploads exactly 4 images to Cloudinary, and saves the room data to the database. Requires all data as multipart/form-data.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "description": "Adı (Metin Gerekli, dosya değil)",
                                        "example": "Luxury Bay Room"
                                    },
                                    "description": {
                                        "type": "string",
                                        "description": "Açıklaması (Metin Gerekli, dosya değil)",
                                        "example": "A stunning view of the Mediterranean."
                                    },
                                    "pricePerNight": {
                                        "type": "number",
                                        "format": "float",
                                        "description": "Gecelik fiyat (Rakam Gerekli, dosya değil)",
                                        "example": 150.99
                                    },
                                    "images": {
                                        "type": "array",
                                        "description": "Yüklenecek **TAM 4 ADET** resim dosyası.",
                                        "maxItems": 4,
                                        "minItems": 4,
                                        "items": {
                                            "type": "string",
                                            "format": "binary"
                                        }
                                    }
                                },
                                "required": [
                                    "name",
                                    "description",
                                    "pricePerNight",
                                    "images"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Room successfully created!",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Room successfully created!"
                                        },
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "savedRoom": {
                                            "type": "object",
                                            "description": "The newly created room document (with Cloudinary image URLs saved).",
                                            "example": {
                                                "_id": "60c72b2f9c1e440000a6c3f1",
                                                "name": "Luxury Bay Room",
                                                "description": "A stunning view of the Mediterranean.",
                                                "pricePerNight": 150.99,
                                                "images": [
                                                    "v1/room-images/short-url-1",
                                                    "v1/room-images/short-url-2",
                                                    "v1/room-images/short-url-3",
                                                    "v1/room-images/short-url-4"
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation Error (e.g., Exactly 4 photos must be uploaded or invalid format).",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Exactly 4 photos must be uploaded."
                                        },
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server or Database Error"
                    }
                }
            }
        },
        "components": {
            "schemas": {
                "User": {
                    "type": "object",
                    "properties": {
                        "_id": {
                            "type": "string"
                        },
                        "firstname": {
                            "type": "string"
                        },
                        "lastname": {
                            "type": "string"
                        },
                        "email": {
                            "type": "string"
                        },
                        "isAdmin": {
                            "type": "boolean"
                        }
                    }
                },
                "Feedback": {
                    "type": "object",
                    "properties": {
                        "_id": {
                            "type": "string"
                        },
                        "description": {
                            "type": "string"
                        },
                        "fromMail": {
                            "type": "string"
                        },
                        "isRead": {
                            "type": "boolean"
                        },
                        "isSoftDeleted": {
                            "type": "boolean"
                        }
                    }
                }
            }
        }
    }
}